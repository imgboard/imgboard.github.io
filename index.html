<html>
	<head>
		<title>ImgBoard</title>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
		<style>
			p {
				font-family: "Lucida Console", monospace;
			}

			.box {
				display: block;
				float: none;
				clear: left;
			}

			.image {
				float:left;
				padding-right: 1em;
				padding-left: 1em;
				padding-bottom: 3em;
			}

			.text {
				position: relative;
				top: -1em;
				display: inline-block;
			}

			button {
				float:right;
				border: none;
				text-align: center;
				text-decoration: none;
				display: inline-block;
			}
		</style>
		<script>
			var resource_url = "https://script.google.com/macros/s/AKfycbwUth6lqxrlBmi1XHIPR7gWe10e5LSGSNicmjVOmQUJ8cDjxgaJ/exec";
			var pull = function() {
				$.ajax({url: resource_url, 
					success: function(result) {
						console.log("Response");
						
						console.log(result);

						var posts = JSON.parse(result);
						var newHTML = "";
						for (var i = 0; i < posts.length; i++) {
							var d = new Date(posts[i].timestamp).toUTCString();
							var txt = posts[i].txt.replace("<","&lt;").replace(">","&gt;");
							newHTML += "<div class=\"box\"><p class=\"text\"><strong>"+posts[i].author+" at "+d+":</strong><br><br>"+txt+"</p><image src=\""+posts[i].img+"\" id=\"image"+i+"\" class=\"image\" style=\"width:10em;height:10em;\" onclick=\"maximize("+i+");\"></image></div>";
						}

						$("#posts").html(newHTML);
					}
				});
			}

			var maximize = function(i) {
				$("#image"+i).css("width","");
				$("#image"+i).css("height","");
				$("#image"+i).attr("onclick","minimize("+i+")");
			}

			var minimize = function(i) {
				$("#image"+i).css("width","10em");
				$("#image"+i).css("height","10em");
				$("#image"+i).attr("onclick","maximize("+i+")");
			}

			$(document).ready(function() {
				console.log("Ready, loading initial posts!");
				pull();
			});
		</script>
	</head>
	<body>
		<div id="top-bar">
			<p><strong><span style="color:blue;font-size:3em;">IMG</span><span style="font-size:3em;">Board</span></strong><button onclick="pull()">Refresh</button>
			<hr>
		</div>
		<div id="posts"><button onclick="pull()">Refresh</button></div>
	</body>
</html>

